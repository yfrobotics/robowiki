
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="机器人领域的公共知识库">
      
      
      
        <link rel="canonical" href="https://wiki.yfworld.com/control/pid/pid_improved/">
      
      
        <meta name="author" content="YunFei Robotics Laboratory">
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.1.3">
    
    
      
        <title>PID Improvement Techniques - 机器人中文维基 (RoboWiki-cn)</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.2cb7adb3.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.f0267088.min.css">
        
          
          
          <meta name="theme-color" content="#ffffff">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Sans:300,400,400i,700%7CFira+Mono&display=fallback">
        <style>body,input{font-family:"Fira Sans",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Fira Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../../_static/css/extra.css">
    
    
      
        
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-60989638-5","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}),document.addEventListener("DOMContentSwitch",function(){ga("send","pageview",document.location.pathname)})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="white" data-md-color-accent="red">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pid-improvement-techniques" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://wiki.yfworld.com" title="机器人中文维基 (RoboWiki-cn)" class="md-header-nav__button md-logo" aria-label="机器人中文维基 (RoboWiki-cn)">
      
  <img src="../../../logo-site.png" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            机器人中文维基 (RoboWiki-cn)
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              PID Improvement Techniques
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          

  

<nav class="md-tabs md-tabs--active" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../.." class="md-tabs__link">
          首页
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../" class="md-tabs__link md-tabs__link--active">
          控制
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../sensing/" class="md-tabs__link">
          传感
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../planning/" class="md-tabs__link">
          规划
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../algorithm/" class="md-tabs__link">
          算法
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../cv/" class="md-tabs__link">
          视觉
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../self-driving/" class="md-tabs__link">
          自动驾驶
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../linux/" class="md-tabs__link">
          Linux
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../arduino/" class="md-tabs__link">
          Arduino
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../raspberrypi/" class="md-tabs__link">
          Raspberry Pi
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../jetson/" class="md-tabs__link">
          Jetson
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../resources/" class="md-tabs__link">
          资源
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://wiki.yfworld.com" title="机器人中文维基 (RoboWiki-cn)" class="md-nav__button md-logo" aria-label="机器人中文维基 (RoboWiki-cn)">
      
  <img src="../../../logo-site.png" alt="logo">

    </a>
    机器人中文维基 (RoboWiki-cn)
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      首页
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="首页" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        <span class="md-nav__icon md-icon"></span>
        首页
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../.." class="md-nav__link">
      <机器人中文维基>
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../intro/" class="md-nav__link">
      写在前面
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../how-to-contribute/" class="md-nav__link">
      如何贡献这个维基？
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../standard/" class="md-nav__link">
      书写规范
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../contributors/" class="md-nav__link">
      贡献者名单
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../about/" class="md-nav__link">
      关于云飞机器人实验室
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      控制
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="控制" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon"></span>
        控制
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../" class="md-nav__link">
      <机器人控制>
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-2" type="checkbox" id="nav-2-2">
    
    <label class="md-nav__link" for="nav-2-2">
      1. 建模
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="1. 建模" data-md-level="2">
      <label class="md-nav__title" for="nav-2-2">
        <span class="md-nav__icon md-icon"></span>
        1. 建模
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../modelling/modelling/" class="md-nav__link">
      Modelling Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modelling/state_space/" class="md-nav__link">
      State Space
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../analysis/" class="md-nav__link">
      2. 分析
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-4" type="checkbox" id="nav-2-4" checked>
    
    <label class="md-nav__link" for="nav-2-4">
      3. PID控制
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="3. PID控制" data-md-level="2">
      <label class="md-nav__title" for="nav-2-4">
        <span class="md-nav__icon md-icon"></span>
        3. PID控制
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../pid/" class="md-nav__link">
      PID Controller
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        PID Improvement Techniques
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      PID Improvement Techniques
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#fixed-sampling-time" class="md-nav__link">
    Fixed Sampling Time
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#derivative-kick" class="md-nav__link">
    Derivative Kick
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tuning-changes" class="md-nav__link">
    Tuning Changes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reset-windup" class="md-nav__link">
    Reset Windup
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#switch-onoff" class="md-nav__link">
    Switch On/off
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#initialization-after-switch" class="md-nav__link">
    Initialization after Switch
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reverse-control" class="md-nav__link">
    Reverse Control
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#other-improvements" class="md-nav__link">
    Other Improvements
  </a>
  
    <nav class="md-nav" aria-label="Other Improvements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#input-filtering" class="md-nav__link">
    Input Filtering
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#timing-compensation" class="md-nav__link">
    Timing Compensation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#feedforward" class="md-nav__link">
    Feedforward
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reset-tiebacks" class="md-nav__link">
    Reset Tiebacks
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ii-term-saturation" class="md-nav__link">
    II term Saturation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dd-term-filtering" class="md-nav__link">
    DD term Filtering
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-dead-zone" class="md-nav__link">
    Error Dead-zone
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output-limitation" class="md-nav__link">
    Output Limitation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dead-band" class="md-nav__link">
    Dead band
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anti-windup" class="md-nav__link">
    Anti Windup
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#event-based-pid-2" class="md-nav__link">
    Event-based PID [2]
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../pid_tuning/" class="md-nav__link">
      PID Parameters Tuning
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mpc/" class="md-nav__link">
      4. MPC控制
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      传感
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="传感" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        传感
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../sensing/" class="md-nav__link">
      <机器人传感>
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      规划
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="规划" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        规划
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../planning/" class="md-nav__link">
      <机器人规划>
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      算法
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="算法" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon"></span>
        算法
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../algorithm/" class="md-nav__link">
      机器人算法
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      视觉
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="视觉" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        <span class="md-nav__icon md-icon"></span>
        视觉
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cv/" class="md-nav__link">
      机器人视觉
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      自动驾驶
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="自动驾驶" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        <span class="md-nav__icon md-icon"></span>
        自动驾驶
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../self-driving/" class="md-nav__link">
      自动驾驶技术指南
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7-2" type="checkbox" id="nav-7-2">
    
    <label class="md-nav__link" for="nav-7-2">
      1. 概述
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="1. 概述" data-md-level="2">
      <label class="md-nav__title" for="nav-7-2">
        <span class="md-nav__icon md-icon"></span>
        1. 概述
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../self-driving/intro/main/" class="md-nav__link">
      自动驾驶介绍
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../self-driving/intro/define/" class="md-nav__link">
      自动驾驶系统定义
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../self-driving/intro/category/" class="md-nav__link">
      自主性等级分类
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7-3" type="checkbox" id="nav-7-3">
    
    <label class="md-nav__link" for="nav-7-3">
      2. 系统
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="2. 系统" data-md-level="2">
      <label class="md-nav__title" for="nav-7-3">
        <span class="md-nav__icon md-icon"></span>
        2. 系统
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../self-driving/system/main/" class="md-nav__link">
      自动驾驶系统
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../self-driving/system/vehicle/" class="md-nav__link">
      自动驾驶车辆
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../self-driving/system/v2x/" class="md-nav__link">
      智能交通
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../self-driving/system/platform/" class="md-nav__link">
      设计与仿真平台
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../self-driving/system/safety/" class="md-nav__link">
      系统安全保障
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../self-driving/system/regulation/" class="md-nav__link">
      政策与法律法规
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7-4" type="checkbox" id="nav-7-4">
    
    <label class="md-nav__link" for="nav-7-4">
      3. 硬件
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="3. 硬件" data-md-level="2">
      <label class="md-nav__title" for="nav-7-4">
        <span class="md-nav__icon md-icon"></span>
        3. 硬件
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../self-driving/hardware/main/" class="md-nav__link">
      自动驾驶硬件
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../self-driving/hardware/hw_overview/" class="md-nav__link">
      硬件总览
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../self-driving/hardware/ccu/" class="md-nav__link">
      中控单元 (AI芯片, GPGPU)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../self-driving/hardware/drive_by_wire/" class="md-nav__link">
      Drive-by-wire
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../self-driving/hardware/communication/" class="md-nav__link">
      车内总线
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../self-driving/hardware/sensors/" class="md-nav__link">
      感知传感器
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../self-driving/hardware/camera/" class="md-nav__link">
      视觉传感器
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7-5" type="checkbox" id="nav-7-5">
    
    <label class="md-nav__link" for="nav-7-5">
      4. 算法
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="4. 算法" data-md-level="2">
      <label class="md-nav__title" for="nav-7-5">
        <span class="md-nav__icon md-icon"></span>
        4. 算法
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../self-driving/algorithm/main/" class="md-nav__link">
      自动驾驶核心算法
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../self-driving/algorithm/sw_overview/" class="md-nav__link">
      系统软件框架总览
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../self-driving/algorithm/image_processing/" class="md-nav__link">
      图像识别与分割
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../self-driving/algorithm/laser_processing/" class="md-nav__link">
      激光点云数据处理
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../self-driving/algorithm/localisation/" class="md-nav__link">
      地图与定位
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../self-driving/algorithm/path_planning/" class="md-nav__link">
      路径规划
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../self-driving/algorithm/decision_making/" class="md-nav__link">
      决策 (Decision Making Process)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../self-driving/algorithm/nlp/" class="md-nav__link">
      自然语言识别与交互
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7-6" type="checkbox" id="nav-7-6">
    
    <label class="md-nav__link" for="nav-7-6">
      5. 实例
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="5. 实例" data-md-level="2">
      <label class="md-nav__title" for="nav-7-6">
        <span class="md-nav__icon md-icon"></span>
        5. 实例
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../self-driving/casestudy/main/" class="md-nav__link">
      自动驾驶案例
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../self-driving/casestudy/apollo/" class="md-nav__link">
      百度无人驾驶
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Linux
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Linux" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        <span class="md-nav__icon md-icon"></span>
        Linux
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../linux/" class="md-nav__link">
      Linux
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Arduino
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Arduino" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        <span class="md-nav__icon md-icon"></span>
        Arduino
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../arduino/" class="md-nav__link">
      Arduino
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      Raspberry Pi
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Raspberry Pi" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        <span class="md-nav__icon md-icon"></span>
        Raspberry Pi
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../raspberrypi/" class="md-nav__link">
      Raspberry Pi
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-11" type="checkbox" id="nav-11">
    
    <label class="md-nav__link" for="nav-11">
      Jetson
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Jetson" data-md-level="1">
      <label class="md-nav__title" for="nav-11">
        <span class="md-nav__icon md-icon"></span>
        Jetson
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../jetson/" class="md-nav__link">
      Nvidia Jetson
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-12" type="checkbox" id="nav-12">
    
    <label class="md-nav__link" for="nav-12">
      资源
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="资源" data-md-level="1">
      <label class="md-nav__title" for="nav-12">
        <span class="md-nav__icon md-icon"></span>
        资源
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../resources/" class="md-nav__link">
      机器人资源
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../resources/simulators/" class="md-nav__link">
      机器人常用可视化仿真工具
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../resources/hardware/" class="md-nav__link">
      机器人硬件平台
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../resources/conferences/" class="md-nav__link">
      机器人会议与期刊列表
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../resources/standard/" class="md-nav__link">
      机器人领域行业标准
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../resources/competitions/" class="md-nav__link">
      机器人竞赛
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../resources/labs/" class="md-nav__link">
      全球机器人实验室
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../resources/materials/" class="md-nav__link">
      机器人图书
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../resources/software/" class="md-nav__link">
      机器人开源工具与软件
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#fixed-sampling-time" class="md-nav__link">
    Fixed Sampling Time
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#derivative-kick" class="md-nav__link">
    Derivative Kick
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tuning-changes" class="md-nav__link">
    Tuning Changes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reset-windup" class="md-nav__link">
    Reset Windup
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#switch-onoff" class="md-nav__link">
    Switch On/off
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#initialization-after-switch" class="md-nav__link">
    Initialization after Switch
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reverse-control" class="md-nav__link">
    Reverse Control
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#other-improvements" class="md-nav__link">
    Other Improvements
  </a>
  
    <nav class="md-nav" aria-label="Other Improvements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#input-filtering" class="md-nav__link">
    Input Filtering
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#timing-compensation" class="md-nav__link">
    Timing Compensation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#feedforward" class="md-nav__link">
    Feedforward
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reset-tiebacks" class="md-nav__link">
    Reset Tiebacks
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ii-term-saturation" class="md-nav__link">
    II term Saturation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dd-term-filtering" class="md-nav__link">
    DD term Filtering
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-dead-zone" class="md-nav__link">
    Error Dead-zone
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output-limitation" class="md-nav__link">
    Output Limitation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dead-band" class="md-nav__link">
    Dead band
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anti-windup" class="md-nav__link">
    Anti Windup
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#event-based-pid-2" class="md-nav__link">
    Event-based PID [2]
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="pid-improvement-techniques">PID Improvement Techniques</h1>
<p>According to [1], a few improvements can be made to improve the so called Beginner's PID. The author of [1] wrote the PID library for Arduino. Here is a list of his advices:</p>
<ol>
<li>Sample Time - The PID algorithm functions best if it is evaluated at a regular
interval. If the algorithm is aware of this interval, we can also simplify some of
the internal math.</li>
<li>Derivative Kick - Not the biggest deal, but easy to get rid of, so we’re going to do
just that.</li>
<li>On-The-Fly Tuning Changes - A good PID algorithm is one where tuning
parameters can be changed without jolting the internal workings.</li>
<li>Reset Windup Mitigation - We’ll go into what Reset Windup is, and implement a
solution with side benefits</li>
<li>On/Off (Auto/Manual) - In most applications, there is a desire to sometimes turn
off the PID controller and adjust the output by hand, without the controller
interfering</li>
<li>Initialization - When the controller first turns on, we want a “bumpless transfer.” That is, we don’t want the output to suddenly jerk to some new value</li>
<li>Controller Direction - This last one isn’t a change in the name of robustness per se.
it’s designed to ensure that the user enters tuning parameters with the correct sign</li>
</ol>
<p>In this section, I will follow his advices and rewrite my version of code to illustrate the main ideas.</p>
<h3 id="fixed-sampling-time">Fixed Sampling Time</h3>
<p>The first thing to make sure is the controller is called at a regular time interval. We can create a periodic control task, making use of ADC sampling interrupts, or we can use OS utilities to test if the specified sampling time has elapsed. With a fixed sampling time, we do not need to calculate the math related to <span><span class="MathJax_Preview">dt</span><script type="math/tex">dt</script></span> every time, and we can incorporate <span><span class="MathJax_Preview">dt</span><script type="math/tex">dt</script></span> into coefficients <span><span class="MathJax_Preview">K_i</span><script type="math/tex">K_i</script></span> and <span><span class="MathJax_Preview">K_d</span><script type="math/tex">K_d</script></span>:</p>
<div class="highlight"><pre><span></span><code><span class="cm">/* ... */</span>

<span class="kt">void</span> <span class="nf">pid_init</span><span class="p">(</span><span class="kt">float</span> <span class="n">kp_</span><span class="p">,</span> <span class="kt">float</span> <span class="n">ki_</span><span class="p">,</span> <span class="kt">float</span> <span class="n">kd_</span><span class="p">,</span> <span class="kt">float</span> <span class="n">dt</span><span class="p">){</span>
  <span class="n">k_p</span> <span class="o">=</span> <span class="n">kp_</span><span class="p">;</span>
  <span class="n">k_i</span> <span class="o">=</span> <span class="n">ki_</span> <span class="o">*</span> <span class="n">dt</span><span class="p">;</span>
  <span class="n">k_d</span> <span class="o">=</span> <span class="n">kd_</span> <span class="o">/</span> <span class="n">dt</span><span class="p">;</span>
  <span class="cm">/* ... */</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">pid_controller</span><span class="p">()</span> <span class="p">{</span>
  <span class="cm">/* ... */</span>
  <span class="n">e_i</span> <span class="o">+=</span> <span class="n">e</span><span class="p">;</span>
  <span class="kt">float</span> <span class="n">u</span> <span class="o">=</span> <span class="n">k_p</span> <span class="o">*</span> <span class="n">e</span> <span class="o">+</span> <span class="n">k_i</span> <span class="o">*</span> <span class="n">e_i</span> <span class="o">+</span> <span class="n">k_d</span> <span class="o">*</span> <span class="p">(</span><span class="n">e</span> <span class="o">-</span> <span class="n">e_p</span><span class="p">);</span>
  <span class="cm">/* ... */</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="derivative-kick">Derivative Kick</h3>
<p>Since error = set-point - input, any change in the set-point would cause an instantaneous change in error, especially for derivative as this change leads to a close-to-infinity large number. When this number is fed into the PID equation, the result will lead to an undesirable spike in the output.</p>
<p><img alt="" src="../assets/markdown-img-paste-20170412223043418.png" /></p>
<p>As <span><span class="MathJax_Preview">\dot{e} = \dot{r} - \dot{y}</span><script type="math/tex">\dot{e} = \dot{r} - \dot{y}</script></span>, we can ignore the setpoint as constant, so <span><span class="MathJax_Preview">\frac{de}{dt} = -\frac{dy}{dt}</span><script type="math/tex">\frac{de}{dt} = -\frac{dy}{dt}</script></span>. This leads to a "Derivative on Measurement" method.</p>
<div class="highlight"><pre><span></span><code><span class="cm">/* ... */</span>
<span class="kt">float</span> <span class="n">y_p</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">pid_controller</span><span class="p">()</span> <span class="p">{</span>
  <span class="cm">/* ... */</span>
  <span class="n">e_i</span> <span class="o">+=</span> <span class="n">e</span><span class="p">;</span>
  <span class="kt">float</span> <span class="n">u</span> <span class="o">=</span> <span class="n">k_p</span> <span class="o">*</span> <span class="n">e</span> <span class="o">+</span> <span class="n">k_i</span> <span class="o">*</span> <span class="n">e_i</span> <span class="o">+</span> <span class="n">k_d</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">y_p</span><span class="p">);</span>
  <span class="cm">/* ... */</span>
  <span class="n">y_p</span> <span class="o">=</span> <span class="n">y</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="tuning-changes">Tuning Changes</h3>
<p>Changing PID parameters while the system is running may cause undesirable behaviors.</p>
<p><img alt="" src="../assets/markdown-img-paste-20170412223856166.png" /></p>
<p>The major change comes from the "I" term. The solution is simply multiply k_i every time instead of multiply it on the overall sum. This leads to a smooth solution without additional computation.</p>
<div class="highlight"><pre><span></span><code><span class="cm">/* ... */</span>
<span class="kt">float</span> <span class="n">ITerm</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">pid_controller</span><span class="p">()</span> <span class="p">{</span>
  <span class="cm">/* ... */</span>
  <span class="n">ITerm</span> <span class="o">+=</span> <span class="n">k_i</span> <span class="o">*</span> <span class="n">e</span><span class="p">;</span>
  <span class="kt">float</span> <span class="n">u</span> <span class="o">=</span> <span class="n">k_p</span> <span class="o">*</span> <span class="n">e</span> <span class="o">+</span> <span class="n">ITerm</span> <span class="o">+</span> <span class="n">k_d</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">y_p</span><span class="p">);</span>
  <span class="cm">/* ... */</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="reset-windup">Reset Windup</h3>
<p>The problem of windup comes from the fact that there is limitations on the output that a PID controller can send. For example, for Arduino, the PWM output can only accept values from 0-255. If the output value reaches this range, the controller should stop increasing its output and stop accumulating integral error. If the controller is not aware its output is not the actual output, the output will saturate and will introduce lag when the setpoint drop back again.</p>
<p><img alt="" src="../assets/markdown-img-paste-20170412224103491.png" /></p>
<p>The C code after this step:</p>
<div class="highlight"><pre><span></span><code><span class="cm">/* ... */</span>
<span class="kt">float</span> <span class="n">u_limit_upp</span> <span class="o">=</span> <span class="n">xxx</span><span class="p">;</span>
<span class="kt">float</span> <span class="n">u_limit_low</span> <span class="o">=</span> <span class="n">xxx</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">pid_controller</span><span class="p">()</span> <span class="p">{</span>
  <span class="cm">/* ... */</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">pid_output_saturated</span><span class="p">(</span><span class="n">u</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">pid_output_reset</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
    <span class="cm">/* roll back the I term */</span>
    <span class="n">ITerm</span> <span class="o">-=</span> <span class="n">k_i</span> <span class="o">*</span> <span class="n">e</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="cm">/* ... */</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">pid_output_saturated</span><span class="p">(</span><span class="kt">float</span> <span class="n">u</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">u</span> <span class="o">&gt;</span> <span class="n">u_limit_upp</span> <span class="o">||</span> <span class="n">u</span> <span class="o">&lt;</span> <span class="n">u_limit_low</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">pid_output_reset</span><span class="p">(</span><span class="kt">float</span> <span class="n">u</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">u</span> <span class="o">&gt;</span> <span class="n">u_limit_upp</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">u_limit_upp</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">u</span> <span class="o">&lt;</span> <span class="n">u_limit_low</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">u_limit_low</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="switch-onoff">Switch On/off</h3>
<p>(In very rare situations), we may want to switch on/off a PID controller and manually feed control input to the process. This action may confuse the controller as it totally lose control of the output.</p>
<p><img alt="" src="../assets/markdown-img-paste-20170412231026842.png" /></p>
<p>The solution is simple, adding a on/off control variable to enable/disable the controller and stop changing its internal state variables.</p>
<div class="highlight"><pre><span></span><code><span class="cm">/* ... */</span>
<span class="kt">int</span> <span class="n">pid_switch_on</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">pid_controller</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">pid_switch_on</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="cm">/* ... */</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">pid_switch</span><span class="p">(</span><span class="kt">int</span> <span class="n">new_state</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">pid_switch_on</span> <span class="o">=</span> <span class="n">new_state</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="initialization-after-switch">Initialization after Switch</h3>
<p>A side effect of using on/off control is that when the controller switches from off to on, an undesirable bump would appear. This is illustrated in the following diagram:</p>
<p><img alt="" src="../assets/markdown-img-paste-20170413001022770.png" /></p>
<p>To make the output smooth after switch back on the controller, we can reset the controller internal variables:</p>
<ul>
<li>"P": the proportional term does not rely on any past information, so it doesn't need any initilization, so P = 0.</li>
<li>"D": set last_input = previous_input, so D = 0.</li>
<li>"I": set ITerm = previous_output, so P + I + D = previous_output.</li>
</ul>
<p>The result controller has a smooth response after switch the controller back on:</p>
<p><img alt="" src="../assets/markdown-img-paste-20170413021327538.png" /></p>
<h3 id="reverse-control">Reverse Control</h3>
<p>For some systems, the increasing in input will result decreasing in output. For example, an inceasing speed of a cooling fan will cause the temerature to go down. To handle these systems, we introduce a direction variable to address the difference between direct/reserve control. The only difference of reverse control is the sign of the PID parameters need to be negative instead of postive in the direct case.</p>
<div class="highlight"><pre><span></span><code><span class="cp">#define DIRECT_CONTROL  (0)</span>
<span class="cp">#define REVERSE_CONTROL (1)</span>
<span class="kt">int</span> <span class="n">direction</span> <span class="o">=</span> <span class="n">DIRECT_CONTROL</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">pid_init</span><span class="p">()</span> <span class="p">{</span>
  <span class="cm">/* ... */</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">direction</span> <span class="o">==</span> <span class="n">REVERSE_CONTROL</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">k_p</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">-</span> <span class="n">k_p</span><span class="p">;</span>
    <span class="n">k_i</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">-</span> <span class="n">k_i</span><span class="p">;</span>
    <span class="n">k_d</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">-</span> <span class="n">k_d</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="cm">/* ... */</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">pid_setdir</span><span class="p">(</span><span class="kt">int</span> <span class="n">d_</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">direction</span> <span class="o">=</span> <span class="n">d_</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<hr />
<h2 id="other-improvements">Other Improvements</h2>
<h3 id="input-filtering">Input Filtering</h3>
<p>To avoid problems of high frequency measurement noise in the derivative part, a low-pass filter is added.</p>
<div>
<div class="MathJax_Preview">U_D(s) = \frac{K T_D s}{1 + s T_D / N}(\gamma Y_{sp}(s) - Y(s))</div>
<script type="math/tex; mode=display">U_D(s) = \frac{K T_D s}{1 + s T_D / N}(\gamma Y_{sp}(s) - Y(s))</script>
</div>
<p><span><span class="MathJax_Preview">\gamma</span><script type="math/tex">\gamma</script></span> is for set-point weighting, which can be interpreted as feedforward from the set point.</p>
<h3 id="timing-compensation">Timing Compensation</h3>
<ul>
<li>The I and D parts are dependent on the actual interval between two control actions. If the interval is inconsistent, we need to compensate them.</li>
</ul>
<h3 id="feedforward">Feedforward</h3>
<h3 id="reset-tiebacks">Reset Tiebacks</h3>
<h3 id="ii-term-saturation"><span><span class="MathJax_Preview">I</span><script type="math/tex">I</script></span> term Saturation</h3>
<h3 id="dd-term-filtering"><span><span class="MathJax_Preview">D</span><script type="math/tex">D</script></span> term Filtering</h3>
<h3 id="error-dead-zone">Error Dead-zone</h3>
<h3 id="output-limitation">Output Limitation</h3>
<h3 id="dead-band">Dead band</h3>
<h3 id="anti-windup">Anti Windup</h3>
<hr />
<h2 id="event-based-pid-2">Event-based PID [2]</h2>
<p>Event Detector (event-trigged) -&gt; PID Controller (time-trigged)</p>
<p>Event trig condition should have small complexity to compare with time-trigged controller:</p>
<p><span><span class="MathJax_Preview">|e(t_k) - e(t_{s}) &gt; e_{lim}|</span><script type="math/tex">|e(t_k) - e(t_{s}) > e_{lim}|</script></span> OR <span><span class="MathJax_Preview">h_{act} &gt; h_{max}</span><script type="math/tex">h_{act} > h_{max}</script></span></p>
<p>which implies the detector operates at the nominal sampling frequency but the PID calculation only performs when an event is detected. This algorithm, however, requires more calculations due to the fact that each time the PID coefficients need to be recalculated.</p>
<p>It is important to filter the measurement noise properly and to set the error limit sufficiently large to avoid trigging control due to noise.</p>
<hr />
<h2 id="references">References</h2>
<ol>
<li>Improving the Beginner’s PID, <a href="http://brettbeauregard.com/blog/2011/04/improving-the-beginners-pid-introduction/">web page link</a></li>
<li>Årzén, K-E. (1999), A Simple Event-Based PID Controller, Paper presented at 14th IFAC World Congress (1999), Beijing, China.</li>
</ol>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../pid/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  上一页
                </span>
                PID Controller
              </div>
            </div>
          </a>
        
        
          <a href="../pid_tuning/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  下一页
                </span>
                PID Parameters Tuning
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/vendor.7e0ee788.min.js"></script>
      <script src="../../../assets/javascripts/bundle.c1ccee15.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "\u590d\u5236", "clipboard.copied": "\u5df2\u590d\u5236", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\uff0c\\u3002]+", "search.placeholder": "\u641c\u7d22", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../../..",
          features: ['navigation.tabs', 'navigation.instant', 'navigation.sections'],
          search: Object.assign({
            worker: "../../../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../../_static/js/mathjaxhelper.js"></script>
      
    
  </body>
</html>